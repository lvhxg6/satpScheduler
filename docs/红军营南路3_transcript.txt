中文语言办公室说'结束'、'完成'、'结束了'、'结束了'、'结束了'。就是从哦这个只是配置了盲石对吧有一个有一个只是配置盲石但是没说开始时间开始你说现在只有一个解号但是没有配置具体的几点如果都不配置几点那现在默认就是零点默认就是零点吗那这块需要加一个呗我觉得加一个吧加一个啊对我这可以行那这块就再加一个时间默认处让它显示零点如果想选的话其他点就让它选那这块就需要跟下一个忙的时间去做一下校验这块行然后可以看一下这个计算执行时间的逻辑就是当前时间小于本月扫描日期反正这个不用我觉得这个不用仔细看了反正就是根据配置的时间加上忙时的去计算出来一个下一次的执行时间对吧如果说你要是配置这个变更了那我就会重新计算但是你当前在跑的任务是不受影响的对是吧这个具体就不看了然后咱看一下这个调整生命周期吧就是配置保存的时候计算下一次的执行时间并持久化然后注册这个这个任务对吧到达了这个时间的话就触发一次调度然后这个调度就判断判断最近一轮是否有未完成的任务如果没有未完成任务那就那就是去创建所有的任务对吧先先说这个调度啊先不说里面具体细节把这个整体的框架咱们先然后一次性创建所有任务这个这个清零这个先不管然后这个先说这条线啊等待这个任务执行完成之后记录这个轮次的结果那其实就是我这次调度已经成功了那你得坚听他那个任务啥时候完成啊不坚听就这个轮次调度跟跟那个任务执行咱们没有任何关系对要有关系吗可以没有关系就是我这次调度成功之后我只要能正常创业任务之后对但是这块会判断说我调M2结果有没有成功比如说如果我都成功了那我这个状态就成功了如果我十个任务里面有两个成功了八个失败了那这块不就是部分成功然后他不是好脸加了一个失败的那个业务系统吗然后就会把失败的那些业务系统列在这对这是这样的然后这计算下一次的那个计算下一次的那个下一个月的执行时间因为这全是自动的嘛就是全是自动的没有手动的然后这块今天下个月执行然后注册下次调度然后这一次就结束了然后如果说如果说有未完成未超过等待时间的也就是说现在还是有进行这种任务对吧然后我就延迟30分钟重新判断一下但是这个时间是需要超过两小时的就是两小时内就是咱们不是有也不是说两小时吧不是有个超时时间配置吗是需要在那个时间范围内循环去做这件事情的你这个还用配延迟三分钟再重新判断吗不用不用这个写死的我就30分钟再去跑一次吗或者是10分钟这个页面不是你是不是说比如我看断我这边来之后我看他上桌里有没有进入的任务如果有的话有的话我就不创业任务我就等待两个小时我是正常来说你现在是我原来是30分钟我再去判对对他们四个30分钟对对对到了两个小时对对对那我就不创业了对我就不创业了如果像你那个你那也行延迟延迟两小时也这样就是说就是对啊对多判断几分那这这块这块有一万判断到最大时间啊对那个最大时间就是他配的嘛对吧然后这块是有这个的嗯然后这边就是有有未完成的已经超时的一个等待时间那我就跳跳过本轮了然后记录就是我记录一下那个轮次的但是又会给他一个状态叫一跳过然后这边有多少资产这个也会寄到库里面但是页面展示不展示再说吧反正这个可以先记录一下然后这个就基本上一个整个调度的一个一个大的逻辑就是就是前提是一次性所有任务都会创建然后调m2的然后会记录他创建是否都成功了或是否都失败了然后其实这一块下面表结给我有我也记录了这一轮次跟任务的一些关系就是这次轮次有哪些任务有那些业务系统这些啊对然后这个这个任务里面有多少资产也都会记录下来但是现在可以可以不展示但是这个数据我觉得可以先存如果以后他们想看的就可以开发页面再给他弄出来这边这个这边是一个整的一个调度的一个生命周期这个有啥问题吗对我也对我也只放你觉得这块哦行那我就那我就反正这这这有几个说明啊就无论本人是否创建了任务都会计算下个月执行的时间并注册因为这就是轮次轮次嘛你的轮次不论成功失败我下个轮次还要去注册创建时间的然后跳过超时后下个月会重新判断如果任务仍未完成则继续跳过就咱们之前说的如果你环境有问题那我就一直跳跳跳我记录是给你展示的就是跳过了让你去解决问题然后成功创建任务后这个会清零我再问一下就是你这边有没有就是说写那个手动去处理手动去创建有手动在下面有有有那个度数下次调度就是你下次调度一个时间嘛就是它里边有一个相当于它是有个触发器你要注册进去对对对如果说你本轮失败了下一次我在手动出发的话你手动出发的时候也会更新这个下次调度的时间吗不会这个下次是按照你那个配置时间去计算出来的你手动买又不行你手动是不需要他去出发的对手动的那一块是没有关系如果说你本月你本月不是已经那个什么了已经过了那个调度时间了对吧过了对呀你就是上一次调度完吗对那你如果是上一轮次你不管成功也好失败也好你下一次你这下一次调度时间是怎么计算的呀就根据你那个配置计算的呀对你配置的那个时间那不是本月已经过了你是不是下个月对呀 计算下个月了对 你开启网络开启网络字开启下一个网络字调度的时候你没关系住者时间是不是网络就不会跑了你这儿我当前这一轮我在创建任务的时候无论是成功还是失败它都会到最后它都会有一个故事它下次调度吧对是吧它都会计算下一次对那你计算你计算的时间是下个月的时间对然后我我网络页我还想我明白你意思你的意思是第一次调度的时候会不会执行是这样你设置的时间如果是在当前时间之后的那肯定会但是如果你设置在当前时间之前的你肯定就不会了你手动租车都是住住到下个月时间行了吗你的这会儿手动调度你不是住住到下次调度时间不是下个月行了吗手动这会儿跟手动没关系全是你配置好之后一保存它就立马会计算你下次执行时间是这个是几点到了那个点的话不就自动执行吗我的意思是你不是注册到下个月去了吗那个时间不是注册到下个月去了吗是这样的我跟你说个完整流程就比如说这去自动配置对吧比如说我这今天是29号了对吧那我配置了1号对吧那针对于本个月的1号那肯定已经过去了对吧那就那就不会执行了那他就会从下一个月的一号开始执行如果说我今天一号我注册的二号那我今天一号注册的二号那就是下一次执行时间就是本月的二号对就是明天去跑他到明天的时候就会跑然后我比如说到明天去跑的时候跑完了之后我会再去根据这个时间去计算下一次的执行时间那可就是下个月的二号然后再去跑就会把这个下月二号时间再注册上去对那你我的意思是你到了二号之后你不是跑一遍了对吧那我五号的时候我在下发下一个任务下发下一个调度的时候五号他是怎么下发是手动下发还是怎么就页面上出发下发我明白你意思你的意思是说手动出发不修改下一次时间是这意思吗对可以是这样的应该也不会影响下一次的但是我会说他不会影响那个调动你手动出发你手动出发他不会影响你就是自动注册的那块你的下一次执行时间是几点你意思是这两个处理翻开了手动出发手动出发自动调动自动调动就是后下面的方法肯定是一样的但是关键点就是手动出发肯定不会影响你那个下一次自动出发时间的对 但是他会判断我只要是判不管是怎么出发的他都得判断上轮有没有任务在进攻呢这个点这个点也对 没事我记录一下出发点这个也是一个边界挺好这块是然后其实这块我想的是在页面再给他一个就比如说我是跳过了有进行中的了那页面就会给他一个提示不执行被捕对他刷新的时候这个提示是要有的比如说上一轮存在未完成一超时的等待人我本月自动跳自动调度一跳过请处理卡车任务等待下个月出发或首通出发这块需要在我的意思是最好是在这一块或在哪给他一个明显的提示是不是在那个冰冻里面给个提示这个里面提示吗但是我觉得他可能不是很直观不知道他看不看我的意思是是不是要在这一块给他一个信息直接就让他看见或者说给他推到一个公告里面也行如果有的话也可以推到如果有的话也可以给他公告里面推一下这样的话他先来一看然后他就知道了干啥事反正都失败了推到公告里面行我把这个记一下到时候我再完事行推到公告里面反正就是大概是大概是这些这几个信息吧联系多元跳过这种可以都可以做一下逻辑然后然后让他走你看如果存在未完成如未潮时那这个就这个就不弄了然后让他就是就不提示了只有上面两个提示然后就继续等对然后这个是页面的一个告警就让他知道现在系统是不是有存在问题好去处理然后下面就有一个自动恢复的一个调度就是服务重启了因为咱们那个不是也没有真的调度的信息没有保存库他只是说用Spring的调度是在内存里面的所以就是服务重启的时候我需要去查一下配置把它调度时间补一下就是重新注册进去嘛然后它就可以再再再再走了这也不影响就是重启也不影响然后然后还有一个出发点这个重启需要重新调度然后就是你配置变更的时候也是需要重新调度的比如说你的开关开了关了对吧然后还有比如说你那个那个啥那个修改日期呀忙时啊或者业务系统啊之类的那些修改其实业务系统应该不会主要跟日期有关系的吧扫描日期修改盲石跟日期有关系的那我就会去把它对去把那个重新注册一下然后这边有一个轮次判断的逻辑这应该就是轮次与轮次之间的了其实刚才说的差不多就是查一下上一轮的是不是有进行中的就不是完成的嘛且不是失败的就是进行中的然后最新一轮最近一轮的任务是否存在未完成的如果要是没有就创建本人如果有的话就就是按照刚才他们那个超时时间的配置去走如果要是超时了就是创建一条那个调度记录但是他这个记录是超时的就是跳过的那么一个状态调度你看这块就基本上就是这个这个是上面的一个那什么没有未完成的创建本人任务等待执行完成就是执行完成是掉AMR接口返回然后记录轮次成功失败部分失败部分失败就包含咱们刚才说的哪些业务系统失败然后有未完成未超时的话就延迟三十分钟重新判断这个逻辑我可以看看不行就直接改成咱们之前说的那种直接两个小时之后对两个小时之后我再看然后我看如果还有的话有的话我就直接跳过就得了对然后计算下个月执行时间住在下载要度 然后这块就是啊 这个是跟这个是对这个等待时间的一个就是描述吧 就是上轮未完成的最大时长超过此时长说明任务可能卡住了 系统不再创建自动新任务然后避免任务堆积需人工处理卡住的任务后再继续就这么就是描述一下然后下面这个这个是说任务的拆分 基本上按照业务系统加最大自然数去拆分就是反正选择10个业务每个10个资产最大的单数配为10那就是10个任务然后创建方式就是一个调度内所有任务一次创建就刚才咱们上面说的那个然后不等待单个任务完成然后调用AMR的接口P量去创建然后立即计算下轨执行时间注册下的调度大概就这样了然后这个任务的执行顺序就不管了就AMR怎么去执行就怎么去执行大概是这样的然后工具咱们那天说的工具它那边不是也有负载吗然后咱们就配这个多少他们如果超了他们自己去负载去最后去看这个这就到BMS了跟AMR它那肯定是只有一个任务的对吧跟咱们这是一对一的那就是这个调度系统只负责创建任务不负责控制顺序执行这个顺序执行就是那个业务系统那我看有一个这个东西其实这是不是也没有了因为我是一次创建的不是你创建任务的时候你要根据业务系统它不就有个排序吗哦 先创建哪个优势的任务啊 就这这个这个执行排序吗就不在这了EO系统那个本身里面显示顺序对吧比优势统排不去吗显示顺序哦行哦等待逻辑说明等待判定值发生在次数之间哦就是那个等待的那个多长时间只是轮次与轮次之间的不是任务与任务之间的这个啊然后比如这个场景就就就不说了然后反正就任务与任务之间的这个是对上面那个描述哦任务不完成的处理就单个任务卡住不影响同轮次其他任务的创建反正我就是一批创建过去你无所谓我也不会等着你这个任务完成我再去然后登个任务卡住会影响下一轮次创建比如说超过时间了你还卡着呢那我就下一轮次就不创建了然后超过等待时间后系统自动跳过本轮这就刚才说的那个因为你有卡着了你就解决问题给你个战略信你去自己看去吧然后自动下发这个就是盲时的配置然后大概是整个月日期和时间段然后月的话基本上这配置的就是盲时就是不扫描吧比如说如果说你要这如果配置一个整个月的话那我是不是这个调度就不用去执行了对他注册的时候他可能就跳过十月了下一次执行时间他不是自动会跳过盲时吗哦哦哦是这个意思那就十月份就不扫不见肉是吧哦我明白了如果指定日期的话就是每个月月日就这些指定的日期是不扫的对然后时间段就是这个天是不扫的然后整理一下如果你要先有月的话这个月都不扫如果没有月有日期有时间的话就这个时间的这个时间段不能扫对明白了那就是先月再日期再时间段对吧明白了其实这个M2那边也有配那个尽早时间段那你这可能就会有冲突啊你比如说有一种不好的情况就是这边配的跟那边不一样我觉得他要在这配那但是你不保障你会有那种情况他两边都配了我觉得这会影响我的意思是说会存在一个边界情况是说你这忙时人家那不忙时你这不忙时你创建任务的时候你到时候就让他们自己看去吧咱们不管从哪儿过去咱们创建完任务之后这个任务执行成功不成功后边就不用管了这些配置是他们现场配置的他们现场合理的自己安排的然后判断应用级就刚才说的月日期时间段就是盲时仅控制任务下发的时机但不控制任务执行的时长你比如说我配置的两个日期之间或者时间段之间我不下发任务但是可能这个时间带任务在执行我下发任务没跑完它在进行中对吧对有可能这个任务进行当中它就在忙时了对这个我们也控制不了所以就先不做先不动然后自动下发资产的范围这个范围应该是说的是这块吧对吧然后是紧上报非上报其实这个这俩是需要在资产表里面有个属性是吗因为是扩展属性扩展属性我自对是吧上方还是非常高行不过那么这个也还好这个只是收集一下那个表结构之间的关系这个我到时候做的时候我会把它当上下文去处理一下然后到时候这个我再去看看我不确定我再问你行选择资产范围然后这个然后EO系统的这边其实没有啥这是咱们之前说的就直接选择目标业务节点不递归查询子节点就是你选啥就是啥就是你选了这个那就你这个业务系统挂到资产我去跑如果你子业务系统你不选如果这个业务系统那样没资产就应该不创建这种了是明白这有一个我这有一个问题你比如说你像这种勾的你勾了上面是不是下面都勾选了现在是这样的是需要做成这样的吗不需要那你的意思就是你选了资产组那下面俩是不需要勾选的对吧对就是你勾选一个就是一个资产你要下面子的你就需要勾选子的对对对那我这个需要记录一下它相当于把这个系统平铺开了就是没有那个负质节点的关系但是你不在展示的时候都有负质节点的关系明白就是展示是需要有的对然后勾显示不需要的对那这块那这块基本上决定了后面的资产的一个范围然后资产查询根据所显业务ID那这个是其实这个资产查询是对的你勾了哪个业务资产的我就拿了ID去查它资产就可以了对吧因为你下面的我就不用根据那个层级码去查了我就根据这个ID去查这块查资产的时候得去分一下类型比如说什么系统活动的不查那些应用的那些然后外部的是只查应用的我觉得外部的区分一点其他的就不用区分了外部的是之前说的系统活动区分活动没查应用的就是你在查资产都是加个类型去过滤比如说我查外部活动或者查它有个类型就是叫应该是严重资产吧那个类型把本能类型条件给加上去就行了这块有不是我不太明白这块类型因为外部多吗还是说就可以指定一两个就是一两个就行了就是一两个去过滤那这块到底是哪个专题有哪个你能给我梳理一下吗可以我下来我给你个探讨对你给我个谈点根据类型编码你去过滤就行了对对对你大概这个给我一下我就具体的我可能列不全机械路口令应该还好是吧对就查出色不色现在这个优先档这有一个按名抹红茶悬这个能做是吧搜索吗树的搜索吧就那业务系统树就这个吧是吧对不是树就是按名称我知道输入名称猛虎茶就是在这输入一个然后下面是跟他一样的猛虎的把这列出来是吗对反正现在那个组件是不支持他不是只支持选吗那我得问问燕姐他组件支持不支持如果不支持我这边也支持不了他要是不支持这个就选起来就很麻烦那得看看组件不行我到时候让他自己写一个应该是可以嗯行待会看看吧啊我他说对如果能实现的话我肯定就实现了然后啊然后这块六就叫完了自动下发的方模式啊这边啊就是这一块其实嗯这一块是不是不同的专题这块的对应的工具也不一样对这块我到时候问一下他那个都有模板去选不管是机械 弱火灵系统动药活动前台他都有个闪模板的四个专题都有模板要选对吧明白这个检测模式是啥工具模式这个是不是就不要了对不要不要然后只有模板嘛对吧然后就是这边是工具然后就是谁家的然后这边是模板对你选了工具选了模板这块就先选的完了是吧嗯哦你原始结果呢原始结果不是也要让他去选择去勾选吗这边应该应该也也有一个勾选叫保存原始系统动外部动的原始结果是否保存原始结果上次沟通的对对,就这两个,对吧就这两个需要有勾选的下面就有这个,对吧但是下边有模板还有那个外部漏洞这两个是有模板的这吧这是吧明白了就是系统漏洞和外部漏洞是有模板的是吧系统漏洞具体那个这个机器人的活量还有系统外部动物怎么查模板怎么查模板你之前你之前创建的时候是有一个模板 模板是写死的写死的 我之前创建的 因为是网络网络就是网管的 他们的模板是固定的 啊 可是是支支豆太配的 我就把那个模板的名称配到库里面了就这块还得查一查相关的模板怎么查对这块好像对你切换不同的工具看模板对模板跟工具是有对应关系的而且跟专题有对应关系可能对吧行我到时候有的工具好像没有模板嗯行我到时候把这个他自己内置了一个就用那一个原始结果这个就是基线和入口链需要有一个这个的勾选了就保存在这里不过就没有扫描记录这个就是后来咱们昨天聊的新加的那个就是扫描记录就是轮次管理就是展示自动下发的去行记录就是支持查看历史扫描情况和手动出发就是这个里面就是你自动下发的和那个什么的都能展示然后这个是那个查询条件就是我改了这一块的一个我就改了这一块然后你看看这块就是查询条件现在我就可以补一下月份和状态就哪个月份的业务系统的话因为它是那种合在一起的就没有价之前也没有业务系统因为这个减通标类型不都是业务系统吗然后我就把这个去了然后状态就留了个状态和这个这个目标名称看看你现在是存右行存存他的idea存名称名称的话你直接来个like就行好行那我可以这块加一个吧然后加一个那叫啥优系统优系统吧就这吧对你就赶上优系统这个计划模板计划模板名不要了吧那就加个目标原生查询对吧就直接赶右系统嗯嗯 行 这加个业务系统查询 然后就是三个月份业务系统和状态 是吧然后列表字段 还有有月份 有轮次 有哪个月份执行的 轮次就是你第几次啊 对吧 你你你自动调度 如果你手动的话就有二或者调动多就是三然后目标名称就是本轮叫的业务系统 这业务系统里面就是如果少的话这块看怎么定吧我这显得是共十个业务系统就是你这次几个又几个然后你竖标放上去的时候会看到详情的一个就上面给你列出来因为你太多的话你太多的话你一列可能也不好呈现或者就是按照那种叠着点展示三个多了就那种也行但是我看做的时候可以做然后失败的业务系统就是咱们刚才说的你第二次接口如果失败有失败的那我就这边给你把那个那什么没有的就没有然后执行时间我把这个也加了一次就是你本轮就这一轮任务什么时候触发调度的然后我就大概列了一下这个完成时间要不要加反正如果是完成时间会有奇异调度他以为是整个任务的完成时间行其实这个是对对对那我这就就是这次轮次的一个指引时间吧什么时候执行的然后后面就加状态成功失败部分失败和一跳过一跳过就是说咱们那种超时的进行中的那就一跳过的部分失败就是调接口方面的然后这个失败就是可能都失败了然后这边成功然后就是你接口任务都创建好了然后这块我只只根据AMR接口返回的那个状态或者什么去判断你比如说到AMR那会儿它调度失败了这个我可能就不去判定了比如说我下了十个任务它因为环境的问题你可能调度都失败了十个任务全失败了那我这份也是显示成功的就跟你后面就没关系了对然后点操作的时候会有一个明细的查看就弹花再看一个明细或者是页面跳转也行然后这个是数据展这个是这个是那个轮次的展示的一个样例月份执行轮次一然后共十个业务系统失败的没有执行实验杀成功这我查看明细然后你点查看明细的时候会展示你这个轮次里面是业务系统资产数AMR的任务ID可以关联就是那个AMR的任务嘛然后开始时间结束时间状态成功失败或者进行中类似的然后失败原因是啥可能就就看看AMR那个状态吧这块我这块就是想把那个明细就是你这一轮次大概是有哪些业务系统资产数有多少AMR任务ID就是这个改成任务名称吧它任务名称是啥开始实验啥结束实验啥成功和失败就这块就把你这一次轮次和AMR任务就大概在这块整体就给你展示一下那个是不是显示任务名称ID什么的这边改成任务名称这个改成任务名称这个改成任务名称这样的话就是我轮次调度的任务你也可以在这看一下我想一下就是说你在不管是手上创建还是自动创建的时候我这个轮次你是有一个有一个名称是标识吗有个标识是吗或者是时间圈就是类似于一个这个轮次现在就一二三四没有说时间圈或什么标识它肯定应该是有那你这么说这应该是有一个状态吧不是分类吧是自动的还是手动的对啊也就是说比如说一个轮次为了一个时间圈设置哪一个然后把这个时间圈给附到那个每个任的一个任务编码或者任务描述那边去这样他在专题那边他好他好就是过去去搜索哦我懂你意思你的意思是其实想让他在AM那边好查这部分对对对其实就是你在创建一个计划的时候任务任务编码或者任务名称后边可以带着这个就可以了哦是所有的任务10个任务那我就这十个任务的电话或者名称或者描述我给它加上去名称上带着是吧对然后你到那块的时候就好它可以去那边我一查是哪个轮次你搜索就查不出来这样的话我哪个轮次然后什么去那一搜我这一批的任务也都能一块查下来对可以这样可以行这是一个名这样的话你这个轮次可能记一个时间数或者是时间数其实挺好的我就按照那种比如说月份前面的后面再加一个我倒是设计一下吧我觉得后面可以还再加一个手动还是自动的那么一个标识然后完了之后后面再加上你轮次你是这个月的第一次第二次第三次第四次你这样的话其实再加上他任务名称你到时候可能就好看了这个往后面一批你一搜我就拿这个一搜都能搜出来行这边是这就是就这个明信里面就展示了他这个业务系统就这个轮次里面爱闻的任务还有这个业务系统还有自然数开始时间结束时间状态就大概给他列了一下你在这也能好知道有哪些这这我看看啊那那其实这块我可以再加一个轮次这样的话你不就复制到这的那个关键信息从这站过来去任务这一查然后就能把你那批任务都露出来是吧其实这块如果做的好的话你也可以带着就从这跳转过去不过先不做了吧现在就是按照你说那种方式让自己去查你错了可以诊破到啊任务列表把条件带过去对呀我说不做了吗你要越说做的越来越多先这样吧不行后面再说然后上面就是那个轮次的这边有一个手动下发新一轮次就是点击下发那个按钮这块就是刚才咱们之前说的这块有个东西就这块不是自动补发吗这块是不是咱们那上次讨论的这块不要了然后再下发新一轮次或者在这对对就这块就是下发新一轮次任务按钮的时候弹出配置框然后这个配置项就是定时开始时间你选一个时间点就行了他不选的话就是立即去就行了明白那就是这块如果你选时间然后就到那个时候再去出发对那我想想那这样的话是不是就影响了那个调度的那块了对 会影响他调度下一次的时间是吧你这块我之所以给他加这个时间就是因为他手动执行有可能白天也不让去创建任务就在忙时吗对有可能就是说我们只能晚上去创建任务那这比如说有个就有个最那什么的我现在就在你配置的忙时里面我这点了下一次发发起下一次任务是不是我就得拦截他不让创建对是吧对这一块也得盼望你当时也没办法忙时是吧如果忙时得那那那那也就是说这个下发新一次任务的时候有可能是马上去触发的因为这不在盲时的那个配置范围内我就可以马上去触发如果要是在盲时的话我这会需要提示他当前是在盲时你去选择一个时间然后下一轮什么去执行对吧但是你选择的时间点有可能会在你计算的下一次执行时间点他们就是说我觉得你就计算王室就行了因为你这儿比如你选了个12比如今天是1号我选了个晚上11点去执行11点去执行但是他上面自动调度他的下次执行时间是12点12点的话你11点其实你不是任务正在执行了吗他到了12点去执行的时候他一看我上次任务还没执行完呢他就会等两个小时去判断嗯如果还没执行完呢那他那个调度就过了其实我觉得跟那个不一样不是其实我在想这个里面是不是就走一个调度就可以了你比如说啊他呃手动出发下一次如果点了这个手动下发就出发这个时候他如果设了时间那我下一次那个调度时间就变成他的这个了也可以啊对吧你变成这个之后你执行完这个之后我再去根据你那个时间去重新计算一个自动调整的时间作为我下一个轮次如果说你手动设置这个时间跟我之前配置的那个下轮时间有冲突了那我之前我就不跑了就按照你手动的去做可以对吧我觉得这样也行这样的话就避免了很多事你选时间点它就重新计算一次对如果说你没有选时间立即可以执行那我就看闲时如果不带闲时你就马上去跑嘛跑完之后也不影响我上一次的那块的自动调度的时间对吧如果你这设时间了那我就把你这个时间作为我下一次的那个时间去做然后它执行完了之后如果我再去按照那个配置再去生成一个手动执行是否选择时间如果选择了时间会需要做下一次调度的时间这块是不是还有还有其他问题就是你比如说它有一个自动执行时间是下一次自动执行时间它不是已经注册进去了吗比如说是12点对吧就是凌晨12点你这儿选一个凌晨1点其实现在这个都还没去执行了那他下次执行是不是就是一点十二点就不执行了对如果你这选对也不是说吧就是是这样的就比如说我今天见的我之前我现在十点我十二点的时候是吧我要做一次自动调度对吧对然后你现在这儿日期又选了一点那按理说我就把你十二点那次取消了我就按照你这个来就做一次一点就像他说他这个邮箱对你这个时间在我调度之前在我下一次调度之前那我就把你的这个在我下一次调度之后吧我就把你那个就取消了我就按照你这个作为下一次的但是你要在我那个调度之后我也会取消但是我会重新计算对 都会取消都会取消不只是这个完了之后这个首次任务完成之后它会重新计算对就像下一次什么时间点就看你配的啥嘛 对吧就这一块是会覆盖你自动执行的那一次的对 反正是你这个叫做完成之后它会重新计算对 反正你每次玩就是如果就是现在就是说你这块配置时间了我就会肯定会重新计算如果你没配置时间我就不计算了对吧因为没配置时间说明你现在立即就执行了可能就跟我下次没关系了下一次可能如果时间比较紧啊比如说我现在是现在是10点我下一次自动调的时候11点那我10点进来任务了我可能三个小时跑不完那我自动的时候可能就跳过了是吧就大概是这个逻辑然后这块还有一个资产范围的说明上一次扫描失败和上一次本轮未扫描的资产反正这块就这种手动的这次我可能需要特意的记录一下因为它这个资产的范围也不大一样因为这个手动的这一块就加上了扫描失败或者是本人扫描失败或者你都不选的话这块影响的资产范围就像这块我看看之前说的这不是有全部吗如果你选的全部就没有关系了就按照我上面配置的资产来如果你后面选了上面失败的资产和这个本人为扫描的资产的话那我就需要带上这个去就是对就是这个应该就是上一轮查询失败的或者是本月扫描未扫描的那些资产我就要把它查一查查出来然后作为作为我这次手动的一个资产的范围去跑一下是吧对对嗯就是就这块这块到时候可能就特殊处理一下哎你再再再就是说本月未扫描到他这个本月未扫描到的资产是不是在你募权的游戏统计范围内我去盘抓吗啊对如果创建完任务之后他应该都会扫不管是成功还是失败是吧就是本月未扫扫不到资产如果能查出资产来之后也有可能会新增资产是吧因为他这只想业务系统有可能就是说他实话扫一次然后中间增加了一些资产那就会把他那个没有扫免就是不再扔我去这块其实处理逻辑也挺复杂的你得把任务里面的资产都漏出来然后再去查一下按照业务资产也好因为他这个也是按照业务资产的维度去下发的那就去创建任务的时候按照他那个业务业务那个重新把资产查一下然后再跟上一次任务关联的资产里面去对比如果不在上面的就说明这次这几个资产是我新增的那就把这个资产几个资产加进去对吧我这我这记一下然后13就是未扫描到的资产这个我到时候再看看哦说明选择规则哦这全部是其他两项智慧哦这是页面的处理的一个东西就是选择全部是其他不可选然后上次骚妙失败自然和本人的同时勾选就是去并集嘛对吧失败的加上这个然后如果他各自勾选那就不看了行下发教业这就是检测盲石然后是否存在自动下发的任务等待超时然后这个这个就是之前说的然后下面应该就没有了下面是与外部系统的交互调M2接口工具传传然后这个所有业务应该就没有了可以看着对照着这个这一块的看看就这块输了盲石也输了EO系统这块也输了然后这块对应的模板关系到时候我得再确认一下然后这一块就没有了然后添加到这弹框的时候去选对吧素伪这块的页面估计得改一下对 我把这个弄一下对 你到时候弄了你再发一份出来我按照这个原型啊对这样行别的地方再改一下啊对然后这还有这个列表还有这个列表我到这个是目标名称这个去了这个检测片类型这个还有我我我那个片里有到时候我截个图发你发你吧哦哦哦哦哦还增加了一个明细的页面到时候我发你可以这块补一下就行按照那个弄嗯啊行啊行那下面再说一下表结构吧然后就是有一张这个扫描配置表这个里面这个里面存的就是就是整个页面的一个关系的整个页面的一个关系看看扫描的类型是是是是我等会啊这一块那按理说是哦 每一个专题都会有一个配置每个专题的配置可能还不大一样是吧嗯 扫描类型是否开启每个月开始扫描日期最大资产数超 呃 任务等待超时然后用ID资产的范围资产范围就是刚才的那个什么呃 这块吧哎 这块紧上不还是啥对吧嗯 然后哦 看看扫描工具ID 模板ID 师傅保存原始结果这个扫描工具ID你是要 这块 这块就是每一个是你选了啥吗啊 这能选俩吗不能吧 这任务一个就要用一个工具对 咱们这只是一个 哦 咱们就一个就得了只是选一个是吧师傅保存原始结果 忙时时间间隔下次执行时间 上次执行时间哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦里面对吧你可以就是你保存配置之后你这个调度下一次执行时间会更新这个表是吧啊对会更新这个表啊对对如果说你保存配置了我就记在这啊然后如果说他会啊会有个地方去记如果对如果说我这次任务执行完了之后我会重新计算了再存在这然后这边下面是配置是那个关联表比如我这这这一个轮次他的扫描配置ID业务系统ID是啥这个这个这个表就是这个ID然后这个执行顺序就是从自家显示顺序去取嗯然后就大概是这样的盲值配置表就是说也是这个ID然后这个是呃年月日什么之类的然后绑定的那个时间这块可能会多选吗这块哦这块这块应该是会多选的哈也可以添加这儿是吧对你添加然后这会又就会有多个这这块应该就是你所有配置的表就都在这了嗯有三个表一个是那个配置的主表然后完了之后业务系统有个关联表然后盲石有个关联本这个这个配置我到时候再看看怎么存吧这个这个他就这个不用存吧他就立即触发一次呢哦不用存也不是啊这个之后不是如果他选时间的话不是立即触发的你比如说你这不是到下一次新发任务吗你下次新发任务的时候弹框吗弹框之后不是你要选时间吗你选一个时间选个自然范围对吧你那个时间如果不是立即执行的话那你不就更新到那个表是吗更新到哪个这个表是吧那我得加两字段因为这一块好像没有这俩没存这个开始时间和结束时间也没存下头这个这个时间点不是不要了吗开始时间结束时间这个不要了对他只选一个你下次执行时间点下次就执行时间点是我明白了如果这个下的执行点这个就直接存下的时间就行了就存在这个表这个下的执行时间是吧就把它剃了就行了然后那我是不是还需要加俩这个对把这个字段加上这个你如果是立即去执行的话我还能根据你选择的我去查如果是选的时间了我就得存一下对得存起来行那我大概我行我这就需要补充一下字段就是这个表需要补充一下补充这里面东西确实挺多补充选择资产范围的字段好行那那配置的基本上现在就是三张表一张主表两张呃关联表然后下面有一个扫描轮次表这个扫描轮次表就是记录了呃扫描配置的ID然后任务次次去然后这边再加一个呃哦容量本我就用这个字段吧改成改成挖刹的然后去做一些那个刚才咱们说那个事然后什么自动出发呀还是手动出发然后这边有个状态然后这边跳步的原因然后下面有一个本轮任务总数对这成功的任务数和失败的任务数然后计划的开始时间按理说这个应该也不说计划开始应该是调度的那个开始时间对吧那个任务总数可能不会等于业务系统数量数对因为你业务系统超过你配定数可能会拆嘛对吧对然后这边有一个任务失败的开始时间实际时间结束时间这都是调度的但是不过现在页面都页面都没有展示我只存了一下不存也行然后下面这个表就是轮次跟任务的一个明细表就轮次的ID业务系统的ID业务系统的名称然后执行的顺序本任务资产数就这一个任务的大概多少资产数AMR任务ID任务名称然后这边是任务的状态我相信啊那个那这样的话如果有任务状态的话我得更新呢是吧对这我觉得那就不存了不要那这个状态我就不存了我只把他那个ID和名称存这就得对是吧对然后甚至后面的开始时间结束时间我都不存了开始时间可以存但是这也都不存了吧这也不存了对吧不然的话你还得维护这个什么创业时间更新时间这个都还得维护一个状态对对对是吧那我那行我我把这些都去掉页面也都去掉啊那差不多就这些字段了反正就是12345有五张表有一个配置表然后配置业务系统关联表还有个配置的盲石表然后这块有个轮次表轮次表一个轮次明细表就把任务的 id 和名称存一下就行了对吧其他的其他的信息啊自然数我也可以存其他我就不存了下面就是刚才跟这个下面跟咱们上面说的那个就是一些边界的一样就不过了吧这是下面是我罗列了一些边界的情况跨年呀接口异常啊轮次规则这个到时候改一改比如说这种出发的时间呀,2月28号出发掉的下,直接一个3月1日3月31号,如果配置了31号啊,那它是2月和28号,那我就2月就需要28号去调度,下的之前就是3月30,类似这种的吧,边界处理,比如5月份啊,或者是并发的处置就是这是一个那个,这个就是设计的时候一些那什么了,我没有做详细的设计,但是这些边界都列出来了,到时候去做那个开发的时候这些应该都会用上包括业务系统资产变端的编辑就是刚才说的如果以这个业务系统下面如果没有资产的话那就是用就跳过就不做了无资产和扫描记录日然后如果所有配置都失败就都是失败的类似这种的然后手动触发的编辑也就是反正也是有一些吧就是本人为扫描的资产但资产已经全部扫描到了提示当前无符合条件的资产不允许创建这个类似这种的然后配置变更就是正在执行的轮次是修改配置那就不受影响嘛正在执行的就不受影响你该怎么着怎么着然后修改业务范围这个就是当前的就按照之前的去做下一次就用新的配置然后修改资产范围这个也是大概这些都是一些边界的一些情况到时候再看看下面这个就是这就没什么要求了这是一个那个关键数目别的应该就没有啥了然后我看看回去我再总结一下吧我看这记了14条到时候再让AI给我整理整理看有哪些就确定点对比一下然后我把它这个弄到PRD文档里面然后再邮件一下出来就作为一个留存吧如果后面这块可能我要维护不了朋友你到时候再弄给你留个比较详细的文档这样的话你下次一看我知道当时是怎么样了是吧逻辑是啥反正我开发肯定会按照这个严格按照这篇文档去开发这样的话跟这个是对的上的如果代码里面有变化我会对应的把这篇文档里面的一些业务逻辑都给改了这个你要是可能用来开发的我们得给提供很详细的信息是吧对这个里面其实业务规则已经很详细了现在缺的是代码缺的是表结构缺的是AI的接口对切口表结构关联关系字段跟那个业务的关系还有AR门的接口还有一些circle就比如说刚才你说的那几类的条件什么之类的你把这些给了他基本上差不多他就能给你开发很快开发出来你让素为那把原型改一下对素为扣扣把原型改改吧我到时候按照你的弄行你不是说给我那个啥对对我一会儿就给你那说一下这个开发周期吧我下周开发测试完差不多吧那你我下周把这个时间晚点说我现在现在时间看你你是不是用完了你可以一分反对我就行哦行行行那那没有了这份你之后要用给你们交接你那个参数的问题你昨天交接了是吗好我那块
