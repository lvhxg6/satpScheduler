# Review Report

## 摘要
本次为“仅文档审查”，对比完整PRD与后端PRD的一致性。整体大部分后端逻辑已覆盖，但仍存在若干关键后端逻辑缺失或描述不完整之处。鉴于文档较长，以下问题可能未穷尽。

## 问题清单

### 高
1) 后端PRD缺失“AMR任务名称格式”生成规则，导致任务命名逻辑不明确。完整PRD要求 AMR任务名称格式为 `{扫描类型}_{轮次标识}_{业务系统名称}`，用于搜索与溯源；后端PRD仅在数据模型中保留 `amr_task_name` 字段但未规定生成规则。涉及任务创建时的后端逻辑一致性。参考：`docs/任务自动下发配置-PRD-20260129120000.md`（8.4.2 AMR任务名称格式）、`docs/任务自动下发配置-PRD-后端-20260129120000.md`（9.5 未说明生成规则）。

2) 后端PRD未明确“模板选择为空/默认模板”的后端处理规则，与完整PRD要求不一致。完整PRD明确“若工具无可选模板，则 template_id 为空，使用工具内置默认模板”，并说明“四个专题都需要选择模板（若工具有可选模板列表）”。后端PRD的“自动下发模式配置”未覆盖这一处理规则，仅描述模板与工具/专题关系，可能导致后端对 template_id 为空的处理缺口。参考：`docs/任务自动下发配置-PRD-20260129120000.md`（7.2/7.1 相关说明）、`docs/任务自动下发配置-PRD-后端-20260129120000.md`（3.4 仅描述模板选择）。

### 中
3) 后端PRD的“盲时配置”描述缺少完整配置项（盲时列表 + 距盲时时间间隔）及其结构化说明，导致配置入参/存储与完整PRD不一致风险。完整PRD明确“盲时列表（支持多条规则）”与“下发任务距盲时时间间隔（小时）”为配置项；后端PRD仅列出盲时类型示例，未在配置项层明确“列表”和“间隔”的参数含义与输入结构（尽管数据模型有 `blind_time_interval` 字段）。参考：`docs/任务自动下发配置-PRD-20260129120000.md`（5.3 配置项）、`docs/任务自动下发配置-PRD-后端-20260129120000.md`（3.2/5.3 未完整覆盖）。

### 低
4) 后端PRD未显式指出“模板列表随工具变化、工具无模板时不需选择”的交互逻辑对后端接口返回/校验的影响（如模板列表为空时允许保存）。虽数据模型已允许 `template_id` 为空，但接口/校验约束未说明，易引起实现差异。参考：`docs/任务自动下发配置-PRD-20260129120000.md`（7.1/7.2）、`docs/任务自动下发配置-PRD-后端-20260129120000.md`（3.4/11.1/11.2 未说明）。

## 修改建议
1) 在后端PRD补充“AMR任务名称格式”生成规则，并标注其用途（检索/溯源），与完整PRD保持一致。
2) 在“自动下发模式配置/接口设计”处补充模板选择规则：工具无模板时 `template_id` 可为空并使用默认模板；模板列表随工具变化。
3) 在“盲时配置”章节补齐配置项结构说明（盲时列表、距盲时时间间隔）与参数约束，确保与数据模型/校验逻辑一致。
4) 在接口校验说明中补充“模板为空”允许范围及对应校验行为，避免实现偏差。

## 一致性校验
本次为文档对比（完整PRD vs 后端PRD），未涉及代码一致性审查。

## 风险/待确认点
- 文档较长且包含较多业务细节，以上差异可能未穷尽；若需要“穷尽式”校验，建议补充一份逐章节映射清单或由产品提供后端逻辑清单作为对照基准。
